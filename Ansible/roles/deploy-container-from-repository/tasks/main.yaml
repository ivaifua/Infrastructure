---
  - name: Log into private registry and force re-authorization
    docker_login:
      registry: eu.gcr.io
      username: _json_key	
      debug: true
      password: " {{ lookup('file', '/var/lib/jenkins/workspace/Terraform/credentials.json')}}" 
  
  - name: Create a network
    docker_network:
      name: microservicesnetwork
   
  - name: Create carts container
    docker_container:
      name: carts
      state: present
      image: eu.gcr.io/silicon-dialect-245108/carts:latest
      networks:
       - name: microservicesnetwork

  - name: Create cartsdb container and connect to network
    docker_container:
      name: cartsdb
      image: "mongo:latest"
      networks:
        - name: microservicesnetwork
      volumes:
        - cartsdb: /data/db

